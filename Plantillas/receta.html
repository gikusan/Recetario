
{% extends "base.html" %}

{% block content %}
<div class="container">
    <div class="section">

        <!--   Icon Section   -->
        <div class="row">
            <h3>{{receta.nombre}}</h3>
        </div>
        <div class="row">
            <div class="col s12 m6">
                <img class="responsive-img" src="/view_photo?id={{id}}">
            </div>

            <div class="col s12 m6" id="ingred">
                <div id="ingred2">
                    <h5>Ingredientes</h5>
                    <p class="light">

                        {% for i in Ingredientes %}

                    <li>{{i.nombre}} {{i.cantidad}} ({{i.descripcion}})</li>

                    {% endfor %}
                    {% if editar=='true' %}
                    <ul>
                        <div class = "row">
                            <input class="col s12 m4" type="text" id="ingrediente" placeholder="Ingrediente" required/>
                            <input class="col s12 m2" type="text" id="cantidad" placeholder="Cantidad" required/>
                            <input class="col s12 m4" type="text" placeholder="Descripci贸n" id="descripcion"/>
                            <input class="col s12 m2" type="button" id="boton_ingrediente" onclick="insertar_ingrediente()" value="Insertar"/>
                        </div>
                    </ul>
                    {% endif %}
                    </p>
                </div>
            </div>

        </div>

        <div class="row">
            <div class="col s12 m6" id="pasos">
                <div id="pasos2">
                    <h5>Descripci贸n de la receta</h5>
                    <p class="light">
                        {{receta.descripcion}}
                    </p>
                    <h5>Descripci贸n de los pasos</h5>
                    <p class="light">
                        {% for p in Pasos %}

                        {% if p.tiempo//60 != 0 %}
                    <li>{{p.descripcion}} ({{p.tiempo//60}} min {{p.tiempo%60}} seg)</li>
                    {% else %}
                    <li>{{p.descripcion}} ({{p.tiempo%60}} seg)</li>
                    {% endif %}
                    {% endfor %}
                    {% if editar=='true' %}
                    <ul>
                        <div class = "row">
                            <input class="col s12 m8" type="text" placeholder="Descripci贸n" id="paso_desc"/>
                            <input class="col s12 m2" type="number" placeholder="Tiempo" id="paso_tim"/>
                            <input class="col s12 m2" type="button" id="boton_paso" onclick="insertar_paso()" value="Insertar"/>
                        </div>
                    </ul>
                    {% endif %}
                    </p>
                </div>
            </div>
        </div>

    </div>
    <br><br>

    <div class="section">

    </div>
</div>
{% if editar=='true' %}
{% block script %}
<script>
    function insertar_ingrediente(){
        var ing = $('#ingrediente').val();
        var can = $('#cantidad').val();
        var des = $('#descripcion').val();

        $.post( "/receta/addIns",{ id: "{{id}}", nombre: ing, descripcion: des, cantidad: can })
        .done(function( data ) {
           alert(data);
           if(data == 'OK'){
                $('#ingred').load(document.URL +  ' #ingred2');
           }else{
                alert("Fallo en la insercion");
           }

        });


    }
    function insertar_paso(){
        var tim = $('#paso_tim').val();
        var des = $('#paso_desc').val();

        $.post( "/receta/addPas",{ id: "{{id}}", tiempo: tim, descripcion: des})
        .done(function( data ) {
           if(data == 'OK'){
                $('#pasos').load(document.URL +  ' #pasos2');
           }else{
                alert("Fallo en la insercion");
           }

        });


    }
</script>

{% endblock %}
{% endif %}
{% endblock %}